<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id: config.xml,v 1.6 2005/10/08 22:57:23 chris Exp $ -->
<chapter>
  <?dbhtml filename="config.html"?>

  <title>Configuration</title>

  <para>This chapter is meant as a reference for most configuration options.
  If you don't know how to get up and running with a basic two interface setup
  and get into the webGUI, please see the Quick Start Guide for your
  platform.</para>

  <para><ulink url="http://doc.m0n0.ch/quickstartsoekris/">Soekris Quick Start
  Guide</ulink></para>

  <para><ulink url="http://doc.m0n0.ch/quickstartpc/">PC Quick Start
  Guide</ulink></para>

  <para><ulink url="http://doc.m0n0.ch/quickstartwrap/">WRAP/ALIX Quick Start
  Guide</ulink></para>

  <sect1 id="Config.Console">
    <?dbhtml filename="config-console.html"?>

    <title id="Config.Console.title">The Console Menu</title>

    <para>On boot, after printing the standard BIOS messages and the FreeBSD
    boot messages, m0n0wall does not show a login prompt, but instead shows a
    simple menu on the console.</para>

    <para>Using the console menu, you can assign the function of each network
    port: LAN, WAN, or OPT for additional optional ports such as a DMZ,
    additional LAN interfaces, a wireless access point, etc. You only need to
    assign the LAN port here, and probably want to assign the WAN interface as
    well. The rest can be done in the webGUI if desired. Change the IP address
    of the LAN port as appropriate for your network, and you are ready to
    connect to the webGUI to set up the remainder of your configuration as
    described in the <link linkend="Config.WebGUI">next section</link>.</para>
  </sect1>

  <sect1 id="Config.WebGUI">
    <?dbhtml filename="config-webgui.html"?>

    <title id="Config.WebGUI.title">The Web GUI</title>

    <para>To edit your m0n0wall configuration, point your web browser at your
    m0n0wall box. m0n0wall runs a web server on the standard web port (80) of
    its LAN connection. When you first connect to your m0n0wall web server, it
    will ask you for a user name and password. The username is <emphasis
    role="bold">admin</emphasis> and the default password is <emphasis
    role="bold">mono</emphasis>. To improve security, change the password in
    the <link linkend="Config.System.General">General Setup</link>
    screen.</para>

    <para>The default m0n0wall configuration may be sufficient for you. If
    not, look through each of the screens, described below, to find the
    specific items you want to change. After you have made and saved your
    changes on the m0n0wall box, remember to download a backup copy of your
    configuration to another machine on your LAN.</para>

    <para>When you first access the m0n0wall webGUI you will see the <link
    linkend="Config.Status.System">System Status screen</link>. Along the left
    hand side of all screens is a menu to allow you to navigate to other
    screens. The items under the Interfaces menu heading may be different in
    your system, depending on how many network interfaces you have and how you
    have named them. The descriptions in the following sections are organized
    in the same way as the items in the navigation menu.</para>

    <note>
      <para>Some of the screen shots in the following sections include blurred
      areas. When you view your m0n0wall screens, these will contain
      information specific to your system.</para>
    </note>
  </sect1>

  <sect1>
    <?dbhtml filename="config-system.html"?>

    <title>The System Screens</title>

    <para></para>

    <sect2 id="Config.System.General">
      <title>General Setup</title>

      <para>The General Setup screen allows you to control some general
      parameters of your firewall.</para>

      <figure>
        <title>The General Setup screen</title>

        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/system/setup.png" />
            </imageobject>
          </mediaobject>
        </screenshot>
      </figure>

      <para>The General Setup screen allows you to change the following
      parameters:</para>

      <table frame="all">
        <title>General Setup parameters</title>

        <tgroup cols="4">
          <colspec colname="description" colnum="2" colwidth="3*" />

          <thead>
            <row>
              <entry>Parameter</entry>

              <entry>Description</entry>

              <entry>Example</entry>

              <entry>Reference</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>Hostname</entry>

              <entry>The unqualified hostname of your firewall.</entry>

              <entry>myfirewall</entry>

              <entry><link linkend="Ref.IP">IP Basics</link></entry>
            </row>

            <row>
              <entry>Domain</entry>

              <entry>The domain name to qualify your firewall
              hostname.</entry>

              <entry>example.com</entry>

              <entry><link linkend="Ref.IP">IP Basics</link></entry>
            </row>

            <row>
              <entry>DNS Servers</entry>

              <entry>The IP address of one or more DNS servers for use by the
              firewall.</entry>

              <entry>10.0.0.123</entry>

              <entry><link linkend="Ref.DNS">DNS</link></entry>
            </row>

            <row>
              <entry>Username</entry>

              <entry>The username to use when connecting to the m0n0wall
              webGUI.</entry>

              <entry>admin</entry>

              <entry></entry>
            </row>

            <row>
              <entry>Password</entry>

              <entry>The password to use when connecting to the m0n0wall
              webGUI. The current password is not displayed; this field is
              used only to change the password You should change this when you
              first install m0n0wall.</entry>

              <entry></entry>

              <entry></entry>
            </row>

            <row>
              <entry>webGUI Protocol</entry>

              <entry>The protocol for the m0n0wall webGUI to use. If you
              select HTTPS, you will need to securely access your webGUI using
              a URL that starts with "https:" and to enter a signed
              certificate and key in the Advanced System page.</entry>

              <entry></entry>

              <entry></entry>
            </row>

            <row>
              <entry>webGUI Port</entry>

              <entry>The port for the m0n0wall webGUI to use, if not the
              default.</entry>

              <entry></entry>

              <entry></entry>
            </row>

            <row>
              <entry>Time zone</entry>

              <entry>The time zone of your firewall. This affects the value of
              times printed to logs.</entry>

              <entry></entry>

              <entry><link linkend="Ref.Logging">Logging</link></entry>
            </row>

            <row>
              <entry>Time update interval</entry>

              <entry>How often your firewall should contact the NTP server to
              update its time.</entry>

              <entry></entry>

              <entry><link linkend="Ref.Logging">Logging</link></entry>
            </row>

            <row>
              <entry>NTP time server</entry>

              <entry>The name of the NTP (Network Time Protocol) server for
              your firewall to use.</entry>

              <entry></entry>

              <entry><link linkend="Ref.Logging">Logging</link></entry>
            </row>
          </tbody>
        </tgroup>
      </table>
    </sect2>

    <sect2>
      <title>Static Routes</title>

      <!--imported Drupal contribution from Fabrizio Fioravanti <fabrizio.fioravanti@finsystem.net>-->

      <para>Static routes are necessary when you have a subnet behind another
      router on any of your internal networks. Static routes are <emphasis
      role="bold">never required for directly connected networks</emphasis> or
      if the network in question is reachable through your WAN interface's
      default gateway.</para>

      <!-- FIXME - put in Visio here depicting when static routes are needed -->

      <para>The Static Routes sub section allow the user to set up static
      routes in order to reach network that must use a gateway different from
      the default one. By pressing the + icon, the system allows the user to
      add new static routes.</para>

      <para>The parameters to set up a new route are the following:</para>

      <itemizedlist>
        <listitem>
          <para>Interface: select the interface to which the route must be
          applied. This is the interface off of which the destination network
          is located.</para>
        </listitem>

        <listitem>
          <para>Destination Network: select the network that have to be
          reached with Classless Inter-Domain Routing (CIDR) code for
          subnetting (see RFC1517, RFC1518, RFC1519, RFC1520 for more
          details)</para>
        </listitem>

        <listitem>
          <para>Gateway: the IP address of the router/gateway that the
          firewall must use in order to reach the defined Destination
          Network</para>
        </listitem>

        <listitem>
          <para>Description: enter an optional description for the inserted
          route</para>
        </listitem>
      </itemizedlist>
    </sect2>

    <sect2>
      <title>Firmware</title>

      <para>The Firmware screen allows you to upgrade or downgrade your
      m0n0wall version (only available if you are running a hard drive or
      compact flash installation).</para>

      <figure>
        <title>The Firmware screen</title>

        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/system/firmware.png" />
            </imageobject>
          </mediaobject>
        </screenshot>
      </figure>
    </sect2>

    <sect2>
      <title>Advanced</title>

      <para>The options on the Advanced System page are intended for use by
      advanced users only, and there's NO support for them.</para>

      <table>
        <title>Advanced System Options</title>

        <tgroup cols="2" tgroupstyle="Format D">
          <colspec colname="col1" colnum="1" colwidth="1*" />

          <colspec colname="col2" colnum="2" colwidth="2*" />

          <thead>
            <row>
              <entry valign="top">Options</entry>

              <entry valign="top">Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>IPv6 tunneling</entry>

              <entry>Add the IP address to NAT encapsulated IPv6 packets (IP
              protocol 41/RFC2893) to here. Don't forget to add a firewall
              rule to permit IPv6 packets!</entry>
            </row>

            <row>
              <entry>Filtering bridge</entry>

              <entry>This will cause bridged packets to pass through the
              packet filter in the same way as routed packets do (by default
              bridged packets are always passed). If you enable this option,
              you'll have to add filter rules to selectively permit traffic
              from bridged interfaces.</entry>
            </row>

            <row>
              <entry>webGUI SSL certificate/key</entry>

              <entry>Paste a signed (firmware 1.2) or create a self signed
              (firmware 1.3b12+) certificate in X.509 and a RSA private key in
              PEM format here.</entry>
            </row>

            <row>
              <entry>Console menu</entry>

              <entry>Changes to this option will take effect after a
              reboot.</entry>
            </row>

            <row>
              <entry>Firmware version check</entry>

              <entry>This will cause m0n0wall not to check for newer firmware
              versions when the System: Firmware page is viewed.</entry>
            </row>

            <row>
              <entry>IPsec fragmented packets</entry>

              <entry>This will cause m0n0wall to allow fragmented IP packets
              that are encapsulated in IPsec ESP packets.</entry>
            </row>

            <row>
              <entry>IPsec DNS check interval (firmware 1.3)</entry>

              <entry>If at least one IPsec tunnel has a host name (instead of
              an IP address) as the remote gateway, a DNS lookup is performed
              at the interval specified here, and if the IP address that the
              host name resolved to has changed, the IPsec tunnel is
              reconfigured. The default is 60 seconds.</entry>
            </row>

            <row>
              <entry>TCP idle timeout</entry>

              <entry>Idle TCP connections will be removed from the state table
              after no packets have been received for the specified number of
              seconds. Don't set this too high or your state table could
              become full of connections that have been improperly shut down.
              The default is 2.5 hours.</entry>
            </row>

            <row>
              <entry>Hard disk standby time</entry>

              <entry>Puts the hard disk into standby mode when the selected
              amount of time after the last access has elapsed. Do not set
              this for CF cards.</entry>
            </row>

            <row>
              <entry>Navigation</entry>

              <entry>Keep diagnostics in navigation expanded.</entry>
            </row>

            <row>
              <entry>Static route filtering</entry>

              <entry>This option only applies if you have defined one or more
              static routes. If it is enabled, traffic that enters and leaves
              through the same interface will not be checked by the firewall.
              This may be desirable in some situations where multiple subnets
              are connected to the same interface.</entry>
            </row>

            <row>
              <entry>webGUI anti-lockout</entry>

              <entry>By default, access to the webGUI on the LAN interface is
              always permitted, regardless of the user-defined filter rule
              set. Enable this feature to control webGUI access (make sure to
              have a filter rule in place that allows you in, or you will lock
              yourself out!). Hint: the "set LAN IP address" option in the
              console menu resets this setting as well.</entry>
            </row>

            <row>
              <entry>IPsec SA preferral</entry>

              <entry>By default, if several SAs match, the newest one is
              preferred if it's at least 30 seconds old. Select this option to
              always prefer old SAs over new ones.</entry>
            </row>

            <row>
              <entry>Device polling</entry>

              <entry>Device polling is a technique that lets the system
              periodically poll network devices for new data instead of
              relying on interrupts. This can reduce CPU load and therefore
              increase throughput, at the expense of a slightly higher
              forwarding delay (the devices are polled 1000 times per second).
              Not all NICs support polling; see the m0n0wall homepage for a
              list of supported cards.</entry>
            </row>

            <row>
              <entry>Firewall states displayed</entry>

              <entry>Maximum number of firewall state entries to be displayed
              on the Diagnostics: Firewall state page. Default is 300. Setting
              this to a very high value will cause a slowdown when viewing the
              firewall states page, depending on your system's processing
              power.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>

      <sect3>
        <title>IPv6</title>

        <para>IPv6 support is included in the latest 1.3beta release (v12 or
        later). The base for this was actually contributed by Michael
        Hanselmann way back in 2005, and with some modifications to reflect
        the changes in m0n0wall since then, as well as a few fixes/
        improvements (most notably easy to configure 6to4 support), it is now
        finally in an official release. (Belated) Thanks, Michael!</para>

        <para>IPv6 support must be explicitly enabled on the System: Advanced
        setup page before any of the new options will become available. Also,
        by default there are no firewall rules for IPv6, so everything is
        blocked. Make sure to add at least a rule on your LAN interface for
        outbound connections if you want to use IPv6.</para>

        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/system/advanced.png" />
            </imageobject>
          </mediaobject>
        </screenshot>

        <para>After IPv6 is activated, additional options will become
        available in the main menu for routing and firewall management.
        Interface pages will also offer additional IPv6 configuration options.
        A useful option under the LAN interface will appear to send IPv6
        Router Advertisements. This allows other hosts on the LAN to
        automatically configure their IPv6 address based on the prefix and
        gateway information that the Firewall provides them.</para>

        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/system/ip6_sys_fw.png" />
            </imageobject>
          </mediaobject>
        </screenshot>

        <caution>
          <para>Since 1.3b12 is the first release with IPv6 support, bugs in
          the implementation are likely. As always, please post on the mailing
          list or in the forum if you've found something odd (with a detailed
          description of what you did, please). Also let us know if everything
          worked "out of the box". :)</para>
        </caution>

        <para>If you don't have native IPv6 connectivity yet, don't worry:
        6to4 tunneling is supported, which should work anywhere you've got a
        (non- firewalled) public IPv4 address. Simply choose "6to4" for the
        IPv6 mode on both the WAN and LAN interfaces - no need to manually
        configure any IPv6 addresses (check the IPv6 RA option on the LAN
        interface and your LAN hosts will be able to automatically obtain an
        IPv6 address). It can also work with dynamic WAN IPv4 addresses (LAN/
        OPT IPv6 subnets are adjusted automatically). Note that some operating
        systems do not use IPv6 when connecting to a host that supports both
        IPv4 and IPv6 if they are configured with a 6to4 IPv6 address (-&gt;
        <ulink url="http://tools.ietf.org/html/rfc3484">RFC 3484</ulink>), so
        use an IPv6-only host (try <ulink
        url="http://ipv6.m0n0.ch">http://ipv6.m0n0.ch</ulink>) for browser
        testing, or simply do a "ping6".</para>

        <para>If you've got native IPv6 connectivity (over PPPoE/PPTP with
        1.3b13 or later), remember that you'll have to statically route your
        m0n0wall's LAN subnet from your upstream router - there's no NAT for
        IPv6 in m0n0wall (and it would be pretty pointless in most cases
        anyway :).</para>

        <para>Also, if you've gotten it to work and need some IPv6 capable web
        sites to try it out, have a look at <ulink
        url="http://sixy.ch">http://sixy.ch</ulink> (or <ulink
        url="http://ipv6.sixy.ch">http://ipv6.sixy.ch</ulink>), a directory of
        IPv6 enabled web sites.</para>

        <note>
          <para>Although many operating systems support IPv6 by default such
          as MacOSX 10.4+, Windows Vista and many Linux packages, some systems
          need it to be activated (such as Windows XP) and some systems may
          not support it at all (such as the Apple iPhone 2.0 and older
          versions of Windows). Check your operating system documentation to
          see if IPv6 is available.</para>
        </note>

        <para>For more information on IPv6 check out some of the following
        websites.</para>

        <itemizedlist>
          <listitem>
            <para><ulink url="http://www.ch.ipv6tf.org/?cid=104">IPv6 Swiss
            Task Force</ulink></para>
          </listitem>

          <listitem>
            <para><ulink url="http://en.wikipedia.org/wiki/Ipv6">Wikipedia
            IPv6</ulink></para>
          </listitem>

          <listitem>
            <para><ulink
            url="http://technet.microsoft.com/en-us/network/bb530961.aspx">Microsoft
            Technet IPv6</ulink></para>
          </listitem>

          <listitem>
            <para><ulink
            url="http://arstechnica.com/articles/paedia/IPv6.ars">ars techna:
            Everything you need to know about IPv6</ulink></para>
          </listitem>

          <listitem>
            <para>IPv6 Tunnel Brokers <ulink
            url="http://en.wikipedia.org/wiki/List_of_IPv6_tunnel_brokers">Wikipedia</ulink>
            or <ulink
            url="http://en.linuxreviews.org/Free_IPv4_to_IPv6_Tunnel_Brokers">LinuxReviews.org</ulink></para>
          </listitem>

          <listitem>
            <para><ulink url="http://www.sixxs.net/misc/coolstuff/">Cool IPv6
            Stuff from sixxs.net</ulink></para>
          </listitem>
        </itemizedlist>
      </sect3>
    </sect2>

    <sect2>
      <title>User Manager</title>

      <para>Additional webGui users can be added here. User permissions are
      determined by the admin group they are a member of.</para>

      <para>Additional webGui admin groups can be added here as well. Each
      group can be restricted to specific portions of the webGUI. Individually
      select the desired web pages each group may access. For example, a
      troubleshooting group could be created which has access only to selected
      Status and Diagnostics pages.</para>
    </sect2>
  </sect1>

  <sect1>
    <?dbhtml filename="config-interfaces.html"?>

    <title>The Interfaces Screens</title>

    <para></para>

    <sect2>
      <title>Assign Interfaces</title>

      <!--imported Drupal contribution from Fabrizio Fioravanti <fabrizio.fioravanti@finsystem.net>-->

      <para>The Assign sub menu allows to map the symbolic reference LAN and
      WAN to the physical interfaces that are present on the system. Click on
      the Save button to apply changes, and remember that a change in this
      assignment will require a system reboot for the changes to take
      effect.</para>
    </sect2>

    <sect2>
      <title>LAN</title>

      <!--imported Drupal contribution from Fabrizio Fioravanti <fabrizio.fioravanti@finsystem.net>-->

      <para>In the LAN section, it is possible to change the IP address and
      the netmask (in CIDR notation) of the firewall internal interface. The
      system must be rebooted in order to apply the changes as suggested after
      pressing the "Save" button.</para>

      <sect3>
        <title>LAN IPv6</title>

        <para>When IPv6 is activated in firmware 1.3 beta 13 or higher,
        additional IPv6 options will become available on the WAN interface.
        </para>

        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/interfaces/lan_1.3_ip6.png" />
            </imageobject>
          </mediaobject>
        </screenshot>
      </sect3>
    </sect2>

    <sect2>
      <title>WAN</title>

      <!--imported Drupal contribution from Fabrizio Fioravanti <fabrizio.fioravanti@finsystem.net>-->

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/interfaces/wan.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>

      <para>In the WAN sub section, it is possible to set up all the
      parameters for WAN interface. The WAN Interface can be a Static IP
      address, a DHCP address, a PPPoE interface or a PPTP connection, as
      detailed in the following. On the basis of the connection type selected,
      the related sub panel must be filled.</para>

      <para>A detailed description of all the fields follows.</para>

      <itemizedlist>
        <listitem>
          <para>Type: the connection type that must be used</para>

          <itemizedlist>
            <listitem>
              <para>Static: A static IP address is assigned to the interface
              with the related netmask and gateway</para>
            </listitem>

            <listitem>
              <para>DHCP: a dynamic address is assigned to the firewall WAN by
              a DHCP server on the WAN side</para>
            </listitem>

            <listitem>
              <para>PPPoE: PPP over Ethernet, that is useful for ADSL
              connection</para>
            </listitem>

            <listitem>
              <para>PPTP: allows to set up PPTP for the ADSL providers that
              requires this protocol for the connection</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>General Configuration Panel: allow to override default MAC
          address and MTU</para>

          <itemizedlist>
            <listitem>
              <para>MAC Address: some cable connections require the MAC
              spoofing. The MAC address must be in the format
              xx:xx:xx:xx:xx:xx</para>
            </listitem>

            <listitem>
              <para>MTU: the value in this field allows to set up MSS clamping
              for TCP connections to the value entered above minus 40 (TCP/IP
              header size). If the field is left blank, an MTU of 1492 bytes
              for PPPoE and 1500 bytes for all other connection types will be
              assumed</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>Static IP Configuration: in this panel the static IP and
          gateway for WAN interface must be set:</para>

          <itemizedlist>
            <listitem>
              <para>IP Address: the static IP with related netmask is set in
              this field</para>
            </listitem>

            <listitem>
              <para>Gateway: the default gateway for the firewall in set in
              this field</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>PPPoE Configuration: The Username and password for the ADSL
          connection should be set up there</para>

          <itemizedlist>
            <listitem>
              <para>Username: the username the provider assign to your
              connection</para>
            </listitem>

            <listitem>
              <para>Password: the password the provider assign to your
              connection</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>PPTP Configuration: the parameters inserted in this sub panel
          allows the user to establish the tunnel required by the PPTP ADSL
          connection</para>

          <itemizedlist>
            <listitem>
              <para>Username: the username the provider assign to your
              connection</para>
            </listitem>

            <listitem>
              <para>Password: the password the provider assign to your
              connection</para>
            </listitem>

            <listitem>
              <para>Local IP Address: the local IP address the provider assign
              to your connection</para>
            </listitem>

            <listitem>
              <para>Remote IP Address: the remote IP address the provider
              assign to your connection</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>Block Private Networks - This option puts in rules to drop
          traffic coming in on the WAN from private IP subnets. If you
          configure your m0n0wall with the WAN interface on a private subnet
          of another LAN, for example, you need to disable this option. Also,
          some ISP's assign customers private IP's, in which case you'll also
          need to disable this option</para>
        </listitem>
      </itemizedlist>

      <note>
        <para>You do <emphasis>not</emphasis> need to disable the Block
        Private Networks option if you are using IPsec VPN tunnels with
        private IP addresses. When the VPN packets come into the WAN
        interface, they will be coming from source IP of the WAN interface of
        the remote VPN device, not from the private IP subnet on the remote
        side.</para>
      </note>

      <sect3>
        <title>WAN IPv6</title>

        <para>When IPv6 is activated in firmware 1.3 beta 13 or higher,
        additional IPv6 options will become available on the WAN
        interface.</para>

        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/interfaces/wan_1.3_ip6.png" />
            </imageobject>
          </mediaobject>
        </screenshot>
      </sect3>
    </sect2>

    <sect2>
      <title>Optional Interfaces</title>

      <para>Optional interfaces can be used for a variety of purposes.
      Generally they are used as second LAN interfaces or DMZ
      interfaces.</para>
    </sect2>

    <sect2>
      <title>Wireless Interfaces</title>

      <para>The wireless interface configuration screen is only presented if a
      compatible wireless card is found at system startup. Options will be
      presented depending on the features supported for the wireless card. See
      the Wireless chapter for more information on wireless configuration
      options.</para>
    </sect2>
  </sect1>

  <sect1>
    <?dbhtml filename="config-services.html"?>

    <title>The Services Screens</title>

    <para></para>

    <sect2>
      <title>DNS Forwarder</title>

      <para>This service allows you to use the fixed IP address of your
      m0n0wall's LAN ethernet interface to resolve/proxy all DNS queries on
      your LAN network. When the m0n0wall DHCP server assigns IP addresses, it
      also assigns the LAN IP address as the DNS server to use. Otherwise, to
      benefit from this service you must manually configure the DNS IP address
      on your computers to be the LAN IP of your m0n0wall.</para>

      <para>If the DNS forwarder is enabled, the DHCP service (if enabled)
      will automatically serve the LAN IP address as a DNS server to DHCP
      clients so they will use the forwarder. The DNS forwarder will use the
      DNS servers entered in System: General setup or those obtained via DHCP
      or PPP on WAN if the "Allow DNS server list to be overridden by DHCP/PPP
      on WAN" is checked. If you don't use that option (or if you use a static
      IP address on WAN), you must manually specify at least one DNS server on
      the System: General setup page.</para>

      <para>This is important for instance if you have your DHCP clients
      renewing their IP address information every 3 days, but every day your
      WAN IP changes from your ISP. If your ISP changed the DNS servers on you
      then it would be 2 days until your DHCP clients received the correct
      information. By using your LAN IP address, all LAN network clients are
      assured of a working DNS server as long as the m0n0wall has received a
      good DNS IP address to use... even if it just received the new DNS
      information a minute ago. This also allows a network administrator to
      easily redirect all traffic to a new internal DNS server (maybe while
      transitioning a new server into the network).</para>

      <para>Setting "Allow DNS server list to be overridden by DHCP/PPP on
      WAN" is necessary if your ISP might change the IP address of the DNS
      server. If you have a static IP address on your WAN than you would not
      need this option set</para>

      <para>The DNS forwarder screen contains configuration options relevant
      to the DNS forwarding server on your m0n0wall.</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/services/dnsforwarder.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para><emphasis role="bold">Enabling the DNS Forwarder</emphasis> Check
      the first checkbox, "Enable DNS forwarder", to enable the service on the
      LAN interface. After enabling this, you will need to configure your
      client machines to use the LAN IP address of your m0n0wall as their DNS
      server.</para>

      <para><emphasis role="bold">DNS Host Name Registration</emphasis></para>

      <para>If your m0n0wall acts as the DHCP server for your LAN, and you
      need name resolution between hosts on the LAN, check the "Register DHCP
      leases in DNS forwarder" box. It will append the default domain in
      System:General setup to the host name of the computer that is requesting
      a DHCP lease. For example, if your machine name is my-pc and your
      default domain is example.com, it will register my-pc.example.com with
      the IP address assigned from DHCP, so the other hosts on your LAN can
      locate your machine by that name.</para>

      <caution>
        <para>Be sure that your computers have unique names.</para>
      </caution>

      <para><emphasis role="bold">DNS Forwarder Overrides</emphasis></para>

      <para>If there are certain DNS host names you want to override for your
      internal DNS clients, add them under DNS overrides on this page. For
      example, if you want www.yourcompany.com to point to a different site
      internally than it does from the Internet, enter an override for
      www.yourcompany.com with the appropriate IP address. This can also be
      used as a rudimentary (and easy to bypass) filter on web sites LAN
      clients can visit, by assigning the undesired host name to an invalid IP
      address. For example, to block www.example.com, put in an override to
      redirect it to an invalid IP address, such as 1.2.3.4. Note that using a
      different DNS server or editing the hosts file on the client machine
      gets around this restriction, but doing this is sufficient to block the
      site for the vast majority of users.</para>
    </sect2>

    <sect2>
      <title>Dynamic DNS</title>

      <para>Dynamic DNS allows you to have a permanent host name that can be
      used to access your network, generally used when your public IP address
      is assigned by DHCP and subject to change. This allows you to run your
      own web server, mail server, etc. using a DNS host name.</para>

      <para>For links to providers of dynamic DNS services, visit the website
      of the dynamic DNS client used by m0n0wall, <ulink
      url="http://www.ez-ipupdate.com/">ez-ipupdate.</ulink></para>

      <para>After you have signed up with one of the dynamic DNS providers
      listed, you can continue.</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/services/dynamicdns.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para><emphasis role="bold">Configuring the Dynamic DNS
      Client</emphasis></para>

      <para>To start, first check the "Enable Dynamic DNS client" box at the
      top of the page.</para>

      <para>In the "Service type" drop down box, select the service you signed
      up with above.</para>

      <para>Some services support <link linkend="gloss.MX">MX DNS
      records</link> on dynamic DNS subdomains. This helps ensure you can get
      email to your host name. If your service supports this (dyndns.org is
      one that does, others do as well), fill in your mail server's host name
      in that field. If you do not need an MX record or if your provider does
      not support them, just leave the field blank.</para>

      <para><emphasis role="bold">Wildcards</emphasis> - If you want to enable
      wildcard on your dynamic DNS host name, check this box. This means all
      host names not specifically configured are redirected to your dynamic
      DNS name. So if your dynamic DNS is example.homeip.net, and you enable
      wildcards, www.example.homeip.net, mail.example.homeip.net,
      anything.example.homeip.net, etc. (i.e. *.example.homeip.net) will all
      resolve to example.homeip.net.</para>

      <para>The next two boxes are for your username and password. Enter your
      account information from the dynamic DNS provider.</para>

      <para>Click Save. Your dynamic DNS host name should immediately be
      updated with your WAN IP address. To verify this, ping your dynamic DNS
      host name. It should resolve to the IP address of the WAN interface of
      your m0n0wall. If not, check Diagnostics: System logs for information on
      why it failed.</para>
    </sect2>

    <sect2>
      <title>DHCP</title>

      <para>This screen allows you to enable the DHCP server on enabled
      Ethernet interfaces other than WAN.</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/services/dhcp.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para><emphasis role="bold">Enabling the DHCP Server</emphasis></para>

      <para>To enable the DHCP server on a particular interface, click on the
      appropriate tab for the interface and check the "Enable DHCP server on
      interface" box.</para>

      <para><emphasis role="bold">Deny unknown clients</emphasis></para>

      <para>This option allows you to implement a more secure DHCP
      configuration. Many companies suffer from worm outbreaks and related
      security issues due to unauthorized machines being plugged into their
      network. This option will help ensure only authorized hosts can receive
      a lease from your DHCP server. With this option enabled, only hosts
      defined at the bottom of this page will receive a lease from
      DHCP.</para>

      <para>The downside to this option is that it can be difficult to
      maintain when you have more than a handful of hosts on your network.
      Many will find the increased security worth the increase in maintenance.
      Note that this is only sufficient to stop the typical user that expects
      to be able to plug into your network and obtain a DHCP lease to get on
      the Internet. Anyone with network and/or security expertise can easily
      bypass this.</para>

      <para>Subnet, Subnet Mask, and Available range are filled in from the IP
      and subnet information from that particular interface.</para>

      <para><emphasis role="bold">Range</emphasis></para>

      <para>In the first box, enter the starting address of your DHCP range.
      In the second box, enter the ending address of the range. Note that you
      don't want to make this the same as the available range, as this
      includes the subnet address and broadcast address, which are unusable,
      as well as the address of your m0n0wall interface which also cannot be
      in the range.</para>

      <para><emphasis role="bold">WINS Servers</emphasis></para>

      <para>If you use an NT 4 domain, or have pre-Windows 2000 clients that
      need to access an Active Directory domain, you will need to fill in your
      WINS server IP addresses in these boxes. If you only have one WINS
      server, leave the second box blank.</para>

      <para><emphasis role="bold">Default and Maximum Lease
      Time</emphasis></para>

      <para>The default lease time is the length of the DHCP lease on any
      clients that do not request a specific expiration time on their DHCP
      lease. The default is 7200 seconds, or two hours. For the vast majority
      of network environments, this is too low. I would generally recommend
      setting this to a week, which is 604,800 seconds.</para>

      <para>The maximum lease time must be more than the default lease time.
      Most networks will not use this value at all. In most instances, I set
      this to one second longer than the default lease time.</para>

      <para>Click Save to save your changes, then click Apply to enable the
      DHCP server.</para>

      <para><emphasis role="bold">Static DHCP Mappings</emphasis></para>

      <para>Static DHCP mappings can be used to assign the same IP address
      every time to a particular host. This can be helpful if you define
      access rules on the firewall or on other hosts on your LAN based on IP
      address, but still want to use DHCP. Alternatively, you can keep the IP
      address box blank to assign an IP out of the available range, when you
      are using the "Deny unknown clients" option.</para>

      <para>Click the + icon at the bottom of the DHCP configuration page to
      add a static DHCP mapping.</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/services/editstatic.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>In the MAC address box, fill in the system's MAC address in the
      format xx:xx:xx:xx:xx:xx. For Windows NT/2000/XP clients, you can get
      determine the MAC address by opening up a command prompt and typing
      'ipconfig'. For Windows 95/98/ME clients, go to Start, Run, winipcfg.
      For Unix clients, use ifconfig.</para>

      <para>In the IP address box, fill in the IP address you want to be
      assigned to the client, or leave it blank to automatically assign one
      from the available DHCP range. If you put in a static IP address, it
      must not be within the range of the DHCP server.</para>

      <para>It is recommended you fill in a description in the Description box
      to remind you what this entry is for, though this is an optional
      value.</para>

      <para>Click Save when you are finished and the mapping will be
      added.</para>

      <note>
        <para>The DNS servers entered in System: General setup (or the DNS
        forwarder, if enabled) will be assigned to clients by the DHCP
        server.</para>

        <para>The DHCP lease table can be viewed on the Diagnostics: DHCP
        leases page.</para>
      </note>
    </sect2>

    <sect2>
      <title>SNMP</title>

      <para>SNMP is a Network Management Protocol that allows a central
      management software to consult information on devices running an SNMP
      agent. You can enable a SNMP agent on your LAN interface on this screen.
      This is useful if you have a network management or monitoring system
      that takes advantage of it. This service uses UDP port 161.</para>

      <caution>
        <para>Retrieving information from a m0n0wall SNMP agent is only
        secured by the community name. All information is transmitted in clear
        text. If you want additional security you will need to either use
        filters to limit who has access to this port or access it over an
        encrypted channel such as PPTP or IPSec.</para>
      </caution>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/services/snmp.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>The System location and System contact boxes can be left blank,
      but can assist you in determining which device you are monitoring if you
      have several monitored hosts.</para>

      <para>The Community is generally set to "public", but if you have any
      regard for security at all, you should set this to something difficult
      to guess, containing numbers and letters. This community name is still
      passed over the network in clear text, so it could be intercepted,
      though the most anyone could get with that community name is information
      on the setup and utilization of your firewall. In most environments,
      this is likely of little to no concern, but is something to keep in
      mind.</para>

      <para>After setting the values as you desire, click Save and your
      changes will be applied.</para>
    </sect2>

    <sect2>
      <title>Proxy ARP</title>

      <para>Proxy ARP can be used if you need m0n0wall to send ARP replies on
      the WAN interface for other IP addresses than its own WAN IP address
      (e.g. for 1:1, advanced outbound or server NAT). It is not necessary if
      you have a subnet routed to you or if you use PPPoE/PPTP, and it only
      works if the WAN interface is configured with a static IP address or
      DHCP.</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/services/proxyarp.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>If you enable 1:1, server, or advanced outbound NAT, you may need
      to enable proxy ARP for the IP address(es) being used by those
      translations. To do so, click the + on this page.</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/services/proxyarpedit.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>Enter either a single IP address, or subnet or range of addresses,
      optionally add a description to remind you why you made this entry, and
      click Save. Then click "Apply changes" for m0n0wall to enable proxy
      ARP.</para>

      <para>For more information on when you do and do not need Proxy ARP, see
      <link linkend="Proxy.ARP">this page</link>.</para>
    </sect2>

    <sect2>
      <title>Captive Portal</title>

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/services/captiveportal.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>

      <para><emphasis role="bold">What is Captive Portal?</emphasis>
      <emphasis>from wikipedia.org</emphasis></para>

      <para>The captive portal technique forces a HTTP client on a network to
      see a special web page (usually for Authentication) before surfing the
      Internet normally. This is done by intercepting all HTTP traffic,
      regardless of address, until the user is allowed to exit the portal. You
      will see captive portals in use at most Wi-Fi hotspots. It can be used
      to control wired access (e.g. apartment houses, business centers, "open"
      Ethernet jacks) as well.</para>

      <para>Check the "Enable captive portal" box to enable.</para>

      <para><emphasis role="bold">Interface</emphasis> - Select the interface
      on which you want to enable captive portal. It can only run on one
      interface at a time.</para>

      <para><emphasis role="bold">Idle timeout</emphasis> - Clients will be
      disconnected after this amount of inactivity. They may log in again
      immediately, though. Leave this field blank for no idle timeout.</para>

      <para><emphasis role="bold">Hard timeout </emphasis>- Clients will be
      disconnected after this amount of time, regardless of activity. They may
      log in again immediately, though. Leave this field blank for no hard
      timeout (not recommended unless an idle timeout is set).</para>

      <para><emphasis role="bold">Logout popup window</emphasis> - If enabled,
      a popup window will appear when clients are allowed through the captive
      portal. This allows clients to explicitly disconnect themselves before
      the idle or hard timeout occurs. When RADIUS accounting is enabled, this
      option is implied.</para>

      <para><note>
          <para>Most any popup stopper will block this window. Worse, you
          cannot exclude a specific site, as this popup appears to come from
          whatever server the user tried to go to prior to authentication. If
          you have a popup blocker, you'll need to disable it prior to logging
          in, and then re-enable it after the log off popup appears.</para>
        </note></para>

      <para><emphasis role="bold">RADIUS server</emphasis> - Enter the IP
      address and port of the RADIUS server which users of the captive portal
      have to authenticate against. Leave blank to disable RADIUS
      authentication. Leave port number blank to use the default port (1812).
      Leave the RADIUS shared secret blank to not use a RADIUS shared secret.
      RADIUS accounting packets will also be sent to port 1813 of the RADIUS
      server if RADIUS accounting is enabled.</para>

      <para><emphasis role="bold">Portal page contents</emphasis> - Here you
      can upload an HTML file for the portal page (leave blank to keep the
      current one, or the default if you have not uploaded one
      previously).</para>

      <para><emphasis role="bold">Authentication error page
      contents</emphasis> - The contents of the HTML file that you upload here
      are displayed when a RADIUS authentication error occurs (generally
      because of an incorrect logon or password).</para>
    </sect2>

    <sect2>
      <title>Wake on LAN</title>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/services/wakeonlan.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>This service can be used to wake up (power on) computers by
      sending special "Magic Packets". The NIC in the computer that is to be
      woken up must support Wake on LAN and has to be configured properly (WOL
      cable, BIOS settings).</para>

      <para>This might be useful, for instance, if you access your home or
      corporate network remotely via VPN, and need to access a machine that
      may not be powered on at all times. You can log into the m0n0wall device
      at that location and send a wake up packet.</para>

      <para>To power on a machine, just choose the appropriate interface, put
      the MAC address of the machine into the MAC address box, and click
      "Send".</para>

      <para>If you use this feature at all, you will probably want to create a
      list of the machines you want to remotely power on. If you click the +
      at the bottom of the screen, you can add a host to the list that is
      displayed. Once you have added the host to your list, you can simply
      click on the MAC address to power on the system.</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/services/wakeonlanedit.png" />
          </imageobject>
        </mediaobject>
      </screenshot>
    </sect2>

    <sect2>
      <title>SIP Proxy</title>

      <para>A SIP proxy configuration page is available starting in firmware
      1.3. This pages activates and configures a SIP proxy/masquerading
      service. Only use it when other Firewall traversal options like using
      STUN or outgoing SIP proxy services aren't offered by your SIP service
      provider. If activated, configure your SIP User Agents (phone) to use
      this server as outbound proxy.</para>

      <table>
        <title>SIP Proxy Parameters</title>

        <tgroup cols="2" tgroupstyle="Format D">
          <colspec colname="col1" colnum="1" colwidth="1*" />

          <colspec colname="col2" colnum="2" colwidth="2*" />

          <thead>
            <row>
              <entry valign="top">Parameter</entry>

              <entry valign="top">Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>Enable SIP Proxy</entry>

              <entry>Enable or disable SIP Proxy</entry>
            </row>

            <row>
              <entry>Interface</entry>

              <entry>Select the interface local to your SIP endpoints like
              VOIP phones. Usually your LAN port.</entry>
            </row>

            <row>
              <entry>SIP UDP port</entry>

              <entry>Default UDP port is 5060. If left at default, this proxy
              also acts as transparent proxy by redirecting outgoing SIP
              messages to this SIP proxy.</entry>
            </row>

            <row>
              <entry>RTP UDP port range</entry>

              <entry>A port range large enough to hold multiple concurrent
              calls. Each audio call needs 2 ports, each video call needs 4
              ports.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>

      <para>When enabled on port 5060, all outgoing SIP messages are
      redirected to this SIP proxy. Firewall rules are added automatically to
      the WAN interface for the UDP SIP signaling and UDP RTP streams to be
      reachable from the outside world. It is possible to use this service as
      a very simple SIP registrar (without authentication, but limited to the
      local LAN subnet). Use the same server for registration and outbound
      proxy.</para>
    </sect2>
  </sect1>

  <sect1>
    <?dbhtml filename="config-status.html"?>

    <title>The Status Screens</title>

    <para></para>

    <sect2 id="Config.Status.System">
      <title id="Config.Status.System.title">System</title>

      <para><figure>
          <title>The System Status screen</title>

          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata fileref="screens/status/system_1.3.png" />
              </imageobject>
            </mediaobject>
          </screenshot>
        </figure></para>
    </sect2>

    <sect2>
      <title>Interfaces</title>

      <para></para>
    </sect2>

    <sect2>
      <title>Traffic Graph</title>

      <para><figure>
          <title>The Traffic Graph screen</title>

          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata fileref="screens/status/trafficgraph.png" />
              </imageobject>
            </mediaobject>
          </screenshot>
        </figure></para>

      <para>The traffic screen allows you to select an interface, and view
      real time throughput graphs on that interface. This feature was
      introduced in version 1.1.</para>

      <para>The Adobe SVG viewer is required to view the graphs. This page has
      a link to the installation for this viewer.</para>
    </sect2>

    <sect2>
      <title>Wireless</title>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/status/wireless.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>More information on wireless features can be found in the Wireless
      chapter.</para>
    </sect2>

    <sect2 id="status.php.page">
      <title>The status.php page</title>

      <para>The ultimate page showing the status of your m0n0wall device is
      actually not shown on the menu. You simply add "/status.php" after the
      ip address of your m0n0wall device, for example
      http://10.0.0.1/status.php. This page will show statistics of the
      following information.</para>

      <warning>
        <para>Make sure to remove any sensitive information (passwords, maybe
        also IP addresses) before posting information from this page in public
        places (like mailing lists)! Passwords in config.xml have been
        automatically removed.</para>
      </warning>

      <itemizedlist>
        <listitem>
          <para>System uptime</para>
        </listitem>

        <listitem>
          <para>Interfaces</para>
        </listitem>

        <listitem>
          <para>Routing tables</para>
        </listitem>

        <listitem>
          <para>Network buffers</para>
        </listitem>

        <listitem>
          <para>Network protocol statistics</para>
        </listitem>

        <listitem>
          <para>Kernel parameters</para>
        </listitem>

        <listitem>
          <para>Kernel modules loaded</para>
        </listitem>

        <listitem>
          <para>ipfw show</para>
        </listitem>

        <listitem>
          <para>ipnat -lv</para>
        </listitem>

        <listitem>
          <para>ipfstat -v</para>
        </listitem>

        <listitem>
          <para>ipfstat -nio</para>
        </listitem>

        <listitem>
          <para>ipfstat -6 -nio</para>
        </listitem>

        <listitem>
          <para>unparsed ipnat rules</para>
        </listitem>

        <listitem>
          <para>unparsed ipfilter rules</para>
        </listitem>

        <listitem>
          <para>unparsed IPv6 ipfilter rules</para>
        </listitem>

        <listitem>
          <para>unparsed ipfw rules</para>
        </listitem>

        <listitem>
          <para>resolv.conf</para>
        </listitem>

        <listitem>
          <para>Processes</para>
        </listitem>

        <listitem>
          <para>dhcpd.conf</para>
        </listitem>

        <listitem>
          <para>ez-ipupdate.cache</para>
        </listitem>

        <listitem>
          <para>rtadvd.conf</para>
        </listitem>

        <listitem>
          <para>df</para>
        </listitem>

        <listitem>
          <para>racoon.conf</para>
        </listitem>

        <listitem>
          <para>SPD</para>
        </listitem>

        <listitem>
          <para>SAD</para>
        </listitem>

        <listitem>
          <para>last 200 system log entries</para>
        </listitem>

        <listitem>
          <para>last 50 filter log entries</para>
        </listitem>

        <listitem>
          <para>ls /conf</para>
        </listitem>

        <listitem>
          <para>ls /var/run</para>
        </listitem>

        <listitem>
          <para>config.xml</para>
        </listitem>
      </itemizedlist>
    </sect2>
  </sect1>

  <sect1>
    <?dbhtml filename="config-diagnostics.html"?>

    <title>The Diagnostics Screens</title>

    <para></para>

    <sect2>
      <title>System Logs</title>

      <para>System logs are available for the following services:</para>

      <itemizedlist>
        <listitem>
          <para>System logs</para>
        </listitem>

        <listitem>
          <para>Firewall</para>
        </listitem>

        <listitem>
          <para>DHCP</para>
        </listitem>

        <listitem>
          <para>Captive Portal</para>
        </listitem>

        <listitem>
          <para>PPTP VPN</para>
        </listitem>

        <listitem>
          <para>SIP (in firmware 1.3 and higher)</para>
        </listitem>
      </itemizedlist>

      <caution>
        <para>The logs are limited to available RAM and are erased after a
        reboot. To store logs permanently you should enable the use of a
        remote syslog server on the Diagnostic Log Settings page.</para>
      </caution>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/diagnostics/systemlogs-system_1.3.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>System log (often called syslog) settings can also be configured
      on this page by clicking on the Settings tab. When sending Syslog to a
      remote server m0n0wall sends UDP datagrams to port 514 on the specified
      remote syslog server. Be sure to set syslogd on the remote server to
      accept syslog messages from m0n0wall and to not block the traffic in any
      intervening firewalls.</para>

      <caution>
        <para>Because of the detailed information that these messages can
        contain about your network it is highly recommended to not send syslog
        messages over the Internet unless they are inside an encrypted tunnel
        like PPTP or IPSec.</para>
      </caution>

      <table>
        <title>Log Settings Parameters</title>

        <tgroup cols="2" tgroupstyle="Format D">
          <colspec colname="col1" colnum="1" colwidth="1*" />

          <colspec colname="col2" colnum="2" colwidth="2*" />

          <thead>
            <row>
              <entry valign="top">Parameter</entry>

              <entry valign="top">Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>Show log entries in reverse order</entry>

              <entry>optionally show logs with the newest on top</entry>
            </row>

            <row>
              <entry>Number of log entries</entry>

              <entry>how many log entries to keep</entry>
            </row>

            <row>
              <entry>Log packets blocked by the default rule</entry>

              <entry>Hint: packets that are blocked by the implicit default
              block rule will not be logged anymore if you uncheck this
              option. Per-rule logging options are not affected.</entry>
            </row>

            <row>
              <entry>Show raw filter logs</entry>

              <entry>Hint: If this is checked, filter logs are shown as
              generated by the packet filter, without any formatting. This
              will reveal more detailed information.</entry>
            </row>

            <row>
              <entry>Resolve IP addresses to hostnames</entry>

              <entry>Hint: If this is checked, IP addresses in firewall logs
              are resolved to real hostnames where possible. Warning: This can
              cause a huge delay in loading the firewall log page! This can
              often be done by a remote syslog server.</entry>
            </row>

            <row>
              <entry>Enable syslog'ing to remote syslog server</entry>

              <entry>Activate the use of a remote syslog server to store log
              messages outside of the m0n0wall device.</entry>
            </row>

            <row>
              <entry>Remote syslog server</entry>

              <entry>The IP address of remote syslog server and which events
              should be sent to the syslog server.</entry>
            </row>
          </tbody>
        </tgroup>
      </table>

      <para>It is recommended that you log your m0n0wall to a remote syslog
      server for diagnostics and forensic purposes. There are a number of free
      tools receive and store syslog messages for you on Windows, Mac, and
      Unix based systems. These software packages also offer additional
      features such as automatically sending pages, emails or SMS messages as
      well as running software or commands based on the messages that are
      received. Some software packages are listed <link
      linkend="Ref.Logging">here</link>.</para>

      <para>Some operating systems that are by default using syslog messages,
      such as MacOSX, may have default configurations that limit reception of
      syslog messages from external sources. If you hav problems receiving
      messages verify that your syslog server software can receive external
      messages.</para>
    </sect2>

    <sect2>
      <title>DHCP Leases</title>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/diagnostics/dhcpleases.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>This screen can be used to view your active and/or expired DHCP
      leases. Clicking the button on this screen will switch between showing
      only active leases and showing both active and expired leases.</para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/diagnostics/dhcpleases-all.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>Expired DHCP leases show up in gray text, while active ones are
      black. (this screenshot from a system with only expired leases)</para>
    </sect2>

    <sect2>
      <title>IPsec</title>

      <para>IPsec maintains two databases with connection details.</para>

      <para><emphasis role="bold">Security Association
      Database</emphasis></para>

      <para>First is the Security Association Database (SAD). This database
      maintains a list of all current IPsec Security Associations
      (SA's).</para>

      <para><emphasis role="bold">Security Policy Database</emphasis></para>

      <para>Second is the Security Policy Database (SPD). This database
      maintains a list of all the IPsec policies on the system. You will have
      two SPD entries for each IPsec VPN connection you have configured,
      regardless of whether the connection is up. This database tells the
      system what traffic will pass over VPN, and specifically which tunnel it
      traverses.</para>

      <table>
        <title>The two entries for each VPN connection are as follows:</title>

        <tgroup cols="5">
          <colspec colname="col1" colnum="1" colwidth="2*" />

          <colspec colname="col2" colnum="2" colwidth="2*" />

          <colspec colname="col3" colnum="3" colwidth="1*" />

          <colspec colname="col4" colnum="4" colwidth="1*" />

          <colspec colname="col5" colnum="5" colwidth="3*" />

          <thead>
            <row>
              <entry>Source</entry>

              <entry>Destination</entry>

              <entry>Direction</entry>

              <entry>Protocol</entry>

              <entry>Tunnel Endpoints</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>local IP subnet for VPN connection</entry>

              <entry>remote IP subnet for VPN connection</entry>

              <entry><mediaobject>
                  <imageobject>
                    <imagedata align="center" fileref="icons/out.gif" />
                  </imageobject>
                </mediaobject></entry>

              <entry>ESP or AH</entry>

              <entry>Public IP address of local m0n0wall - Public IP address
              of remote endpoint</entry>
            </row>

            <row>
              <entry>remote IP subnet for VPN connection</entry>

              <entry>local IP subnet for VPN connection</entry>

              <entry><mediaobject>
                  <imageobject>
                    <imagedata align="center" fileref="icons/in.gif" />
                  </imageobject>
                </mediaobject></entry>

              <entry>ESP or AH</entry>

              <entry>Public IP address of remote endpoint - Public IP address
              of local m0n0wall</entry>
            </row>
          </tbody>
        </tgroup>
      </table>

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/diagnostics/ipsec-sad.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>

      <para>At this screen, you will see two entries for each IPsec connection
      that has been successfully negotiated. One from the local public IP to
      the remote endpoint's public IP, and one in the opposite direction. This
      indicates that IPsec negotiations were successful, and that traffic
      should now be passing your VPN connection if everything else is
      configured appropriately.</para>

      <para>By clicking on the X, you can delete the SA. m0n0wall will attempt
      to recreate it after deleting it. If you have a VPN connection with
      duplicate SA's (more than one from same src to same dst) and the
      connection has gone down, delete all the SA's associated with the
      connection. It should renegotiate and come back up within a few
      seconds.</para>

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/diagnostics/ipsec-spd.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>
    </sect2>

    <sect2>
      <title>Ping/Traceroute</title>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/diagnostics/ping_1.3.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>This screen gives you a GUI to ping (send ICMP echo request) from
      the m0n0wall. Fill in the IP address or hostname of the machine to ping,
      choose the number of pings in the count drop down, and click the Ping
      button.</para>

      <para><note>
          <para>The m0n0wall ping screen cannot ping over VPN connections for
          the same reason SNMP does not work over VPN out of the box. See
          <link linkend="FAQ.SNMPoverVPN">this FAQ entry</link> for more
          information. So do not use this screen as an indicator of whether
          your VPN is working.</para>
        </note></para>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata fileref="screens/diagnostics/traceroute_1.3.png" />
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>This screen gives you a GUI to traceroute from the m0n0wall. Fill
      in the IP address or hostname of the machine whose route you want to
      trace, choose the maximum number of hops in the drop down, and click the
      Traceroute button.</para>

      <para><note>
          <para>The m0n0wall ping screen cannot make traceroutes over VPN
          connections for the same reason SNMP does not work over VPN out of
          the box. See <link linkend="FAQ.SNMPoverVPN">this FAQ entry</link>
          for more information. So do not use this screen as an indicator of
          whether your VPN is working.</para>
        </note></para>
    </sect2>

    <sect2>
      <title>ARP Table</title>

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/diagnostics/arp_1.3.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>

      <para>This page shows the current ARP table of the m0n0wall
      device.</para>
    </sect2>

    <sect2>
      <title>Firewall State</title>

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/diagnostics/firewall_1.3.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>

      <para>This page shows the current Firewall state table. Optionally take
      a snapshot of the state stable and compare it to the current
      table.</para>
    </sect2>

    <sect2>
      <title>Reset State</title>

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/diagnostics/resetstate.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>

      <para>This screen allows you to reset the state tables on your m0n0wall
      for the NAT and firewall state tables.</para>

      <para>Just check the boxes for the table(s) you want to clear, and click
      the Reset button.</para>

      <para>Resetting the state tables will remove all entries from the
      corresponding tables. This means that all open connections will be
      broken and will have to be re-established. This may be necessary after
      making substantial changes to the firewall and/or NAT rules, especially
      if there are IP protocol mappings (e.g. for PPTP or IPv6) with open
      connections.</para>

      <para>The firewall will normally leave the state tables intact when
      changing rules.</para>

      <para>NOTE: If you reset the firewall state table, the browser session
      may appear to be hung after clicking "Reset". Simply refresh the page to
      continue.</para>
    </sect2>

    <sect2>
      <title>Backup/Restore</title>

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/diagnostics/backuprestore.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>

      <para>This screen allows you to backup your existing configuration, or
      restore a previous backup file. These files are text based XML
      files.</para>

      <para>To backup your m0n0wall, click the "Download configuration"
      button. This will download a file called (by default) config.xml.</para>

      <para>If you ever need to restore a previous backup file, go to this
      page, and under the "Restore configuration" section, click Browse.
      Locate the config.xml file you backed up above.</para>
    </sect2>

    <sect2>
      <title>Factory Defaults</title>

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/diagnostics/factorydefaults.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>

      <para>Clicking Yes on this page will reset m0n0wall to the default out
      of the box configuration options and clear any configuration you have
      done on the device.</para>

      <para>If all else fails when trying to configure something on your
      m0n0wall, sometimes it is easiest to start over from scratch on the
      entire configuration. In that instance, use this feature to reload the
      default settings.</para>
    </sect2>

    <sect2>
      <title>Reboot System</title>

      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata fileref="screens/diagnostics/rebootsystem.png" />
            </imageobject>
          </mediaobject>
        </screenshot></para>

      <para>Click Yes on this page to reboot the system.</para>

      <para>As a general rule of thumb in m0n0wall and FreeBSD in general,
      rebooting probably isn't going to fix any problems you are having. But
      it is worth a shot in many circumstances.</para>

      <para>Unlike so many systems, rebooting isn't a suggested maintenance
      procedure on m0n0wall. There is no need to reboot the system unless you
      have a specific reason for doing so.</para>
    </sect2>
  </sect1>
</chapter>